---
title: "Environmental Enforcement Watch"
output: 
  html_paged:
    number_sections: false
    css: ["custom3.css"]
---

```{r setup, include=FALSE}
library(tidyverse)
library(pagedown)
library(palmerpenguins)
library(patchwork)
library(here)
library(ggplot2)
library(tidyr)
library(dplyr)
library(shiny)
library(extrafont)
library(viridis)
library(grid)
library(gridExtra)
library(fishualize)
library(kableExtra)
library(ggrepel)
library(stringr)
loadfonts()


knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r readData, echo=FALSE}

#reading in all of the data and naming it based on the name of the .csv up to the first 2 underscores
#national data
filenames = list.files(here("nationalstats"), pattern = ".csv")
file_count = length(filenames)
for (i in filenames){  
  name <- gsub("^([^_]*_[^_]*)_.*$","\\1", i)
  assign(name, read.csv(here("nationalstats", i)))
}

names(USAinspectionsper1000_All)[1] <- "Program"
names(USAviolationsper1000_All)[1] <- "Program"
inflation <- inflation.csv
names(inflation)[2] <- "base"
housemembers <- housememberinfo.csv

#each time this section is run, change "here" to specify the subfolder for the district or state 
#Also, the way it is set up, you're going to need to cntrl f to change the district and date for the files
filenames = list.files(here("VA4"), pattern = ".csv")
file_count = length(filenames)
for (i in filenames){  
  name <- gsub("^([^_]*_[^_]*_[^_]*_[^-]*-[^-]*)-.*$","\\1", i)
  assign(name, read.csv(here("VA4", i)))
}

activefacilities <- `active-facilities_All_pg3_VA-4`

#set up a theme default to reduce code block later 
theme_meg <- function () { 
  theme_bw(base_family="Georgia") %+replace% 
    theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),panel.border = element_blank(),
          axis.line = element_line(colour = "black"), axis.title.x=element_text(face = "bold", size = 12), 
          axis.title.y=element_text(face = "bold", size = 10, angle=90), plot.title=element_text(face = "bold", size = 14, hjust =.5), 
          axis.text.x=element_text(face = "bold", size = 14), axis.text.y=element_text(face = "bold", size = 8))
}

```
  <div class="title"><span style="padding-left: 150px">
 Congressional Report Card
 </span></div>
 <hr style="height:3px;border-width:0; margin-left:15px; margin-right:15px;color: #b9b9b9;background-color: #b9b9b9; margin-top: 0em; margin-bottom: 0em">
##### Virginia's 4th District; seat held by Donald McEachin since 2017 
 <div class="container">
  <img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/CA36/CA2_map2.png" alt="Snow" style="width:100%;">
  </div>
<a href="https://www.environmentalenforcementwatch.org/"><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/reportcards/eew_logo.png" style="float: left; width: 12%; margin-left: 30%"></a>
<a href="https://envirodatagov.org/"><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/reportcards/edgi_logo.png" style="float: right; width: 20%; margin-right: 30%" ></a>

\pagebreak


<h4>DRAFT not for circulation <span style="padding-left:450px">Page 1</span></h4>

# Introduction 

## Why Report Cards on compliance with and enforcement of Environmental Laws?
The Environmental Protection Agency (EPA) is charged by Congress to  enforce laws that protect people from air pollution, water pollution and hazardous waste. Without effective enforcement, **these laws are meaningless**. Congress can strengthen EPA enforcement by increasing EPA’s budget, passing more effective laws, requiring better data collection, and holding the EPA accountable when it fails to protect people.

This report card analyzes available data from the EPA’s Enforcement and Compliance History Online (ECHO) database regarding violations, inspections and enforcement actions made under the Clean Air Act (CAA), Clean Water Act (CWA) and Resource Conservation and Recovery Act (RCRA).


## What is a "regulated facility"? 
<a ><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/reportcards/facilities2.png" style="float: center; width: 60%" ></a>

## Key changes in this District under the Trump Administration:*

```{r echo=FALSE}

##getting %difference CWA violations
CWAviolations <- `violations_CWA_pg6_VA-4`
names(CWAviolations)[2] <- "Count"
names(CWAviolations)[1] <- "YEAR"
CWAviolations <- CWAviolations[-c(20),]
CWAviolations$President <- as.character("Bush")
CWAviolations[9:16,3] <- as.character("Obama")
CWAviolations[17:19,3] <- as.character("Trump")

vCWAchange <- data.frame("BushObamaAverage" =mean(CWAviolations[1:16,2]),
                             "Trump Average" =mean(CWAviolations[17:19,2]))

vCWAchange$PercentDifference <- as.numeric(100*(vCWAchange[1,2]-vCWAchange[1,1])/
                                                 vCWAchange[1,1])
vCWAchange$PercentDifference <-round(vCWAchange$PercentDifference,0)

vCWAchange$Extra <- ifelse((vCWAchange$PercentDifference>=100)|(vCWAchange$PercentDifference<=-100), "much", "")
vCWAchange$Change <- ifelse(vCWAchange$PercentDifference<0, "better", "worse")

vCWAchange$Positive <- abs(vCWAchange$PercentDifference)
vCWAchange$Value <- ifelse(vCWAchange$PercentDifference>=0, "increase", "decrease")

#enforcement % difference
enforcement <- `enforcements_All_pg3_VA-4`
names(enforcement)[1] <- "Date"
enforcement <- enforcement[-c(20),]
enforcement$Amount <- round(enforcement$Amount,2)
#add presidental years
enforcement$President <- as.character("Bush")
enforcement[9:16,4] <- as.character("Obama")
enforcement[17:19,4] <- as.character("Trump")

actionchange <- data.frame("BushObamaAverage" =mean(enforcement[1:16,3]),
                             "Trump Average" =mean(enforcement[17:19,3]))

actionchange$PercentDifference <- as.numeric(100*(actionchange[1,2]-actionchange[1,1])/
                                                 actionchange[1,1])

actionchange$PercentDifference <-round(actionchange$PercentDifference,0)

actionchange$Extra <- ifelse((actionchange$PercentDifference>=100)|(actionchange$PercentDifference<=-100), "much", "")
actionchange$Change <- ifelse(actionchange$PercentDifference<0, "worse", "better")

actionchange$Positive <- abs(actionchange$PercentDifference)
actionchange$Value <- ifelse(actionchange$PercentDifference>=0, "increase", "decrease")

```

<h3>Clean Water Act Violations: <span style="color:#569b5e">`r vCWAchange[1,4]` `r vCWAchange[1,5]`</span> than the previous 16 years, representing a <span style="color:#569b5e">`r vCWAchange[1,6]`% `r vCWAchange[1,7]`</span> in violations</h3>

<br />

<h3>Enforcement Actions under CAA, CWA, and RCRA: <span style="color:#569b5e">`r actionchange[1,4]` `r actionchange[1,5]`</span> than the previous 16 years, representing a <span style="color:#569b5e">`r actionchange[1,6]`% `r actionchange[1,7]`</span> in enforcement actions</h3>

*see data limitations page for metric calculations


\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 2</span></h4>
```{r echo=FALSE}
#CAA

##first let's fix up the data
#ok so We'll put the % in the title for the state, and try to figure out the same for VA 4
CAArecurring <- `recurring-violations_All_pg3_VA-4`[-c(2,3,5,6),]
CAArecurring <- CAArecurring %>%
  select(CD,Facilities, Percent)
names(CAArecurring)[1] <- "Region"
CAArecurring[1,1] <- as.character("Rest of State")
CAArecurring[2,1] <- as.character("VA 4")
CAArecurring$Region2 <- as.character("All of OR")
CAArecurring[2,4] <- as.character("VA 4")
CAArecurring$RecurringViolators <- (as.numeric(CAArecurring[1,2]-CAArecurring[2,2]))
CAArecurring[2,5] <- as.numeric(CAArecurring[2,2])
CAArecurring$Proportional <- (as.numeric((100/(CAArecurring[1,2]))*CAArecurring[1,5]))
CAArecurring[2,6] <- as.numeric(100-CAArecurring[1,6])
CAArecurring[3] <-round(CAArecurring[3],2)

#CWA

##first let's fix up the data
#ok so We'll put the % in the title for the state, and try to figure out the same for VA 4
CWArecurring <- `recurring-violations_All_pg3_VA-4`[-c(1,3,4,6),]
CWArecurring <- CWArecurring %>%
  select(CD,Facilities, Percent)
names(CWArecurring)[1] <- "Region"
CWArecurring[1,1] <- as.character("Rest of State")
CWArecurring[2,1] <- as.character("VA 4")
CWArecurring$Region2 <- as.character("All of OR")
CWArecurring[2,4] <- as.character("VA 4")
CWArecurring$RecurringViolators <- (as.numeric(CWArecurring[1,2]-CWArecurring[2,2]))
CWArecurring[2,5] <- as.numeric(CWArecurring[2,2])
CWArecurring$Proportional <- (as.numeric((100/(CWArecurring[1,2]))*CWArecurring[1,5]))
CWArecurring[2,6] <- as.numeric(100-CWArecurring[1,6])
CWArecurring[3] <-round(CWArecurring[3],0)

#RCRA

##first let's fix up the data
#ok so We'll put the % in the title for the state, and try to figure out the same for VA 4
RCRArecurring <- `recurring-violations_All_pg3_VA-4`[-c(1,2,4,5),]
RCRArecurring <- RCRArecurring %>%
  select(CD,Facilities, Percent)
names(RCRArecurring)[1] <- "Region"
RCRArecurring[1,1] <- as.character("Rest of State")
RCRArecurring[2,1] <- as.character("VA 4")
RCRArecurring$Region2 <- as.character("All of OR")
RCRArecurring[2,4] <- as.character("VA 4")
RCRArecurring$RecurringViolators <- (as.numeric(RCRArecurring[1,2]-RCRArecurring[2,2]))
RCRArecurring[2,5] <- as.numeric(RCRArecurring[2,2])
RCRArecurring$Proportional <- (as.numeric((100/(RCRArecurring[1,2]))*RCRArecurring[1,5]))
RCRArecurring[2,6] <- as.numeric(100-RCRArecurring[1,6])
RCRArecurring[3] <-round(RCRArecurring[3],2)
```

```{r echo=FALSE}
##getting %difference effluent violations

##So, we're going to do the first 3 years of Obama and Trump so average
#[9:11,2] Obama
# [17:19,2] Trump
effluentviolations <- `effluent-violations_CWA_pg3_VA-4`
effluentviolations <- effluentviolations[-c(20),]
effluentchange <- data.frame("Obama Average" =mean(effluentviolations[9:11,2]),
                             "Trump Average" =mean(effluentviolations[17:19,2]))
effluentchange$PercentDifference <- as.numeric(100*(effluentchange[1,2]-effluentchange[1,1])/
                                                 effluentchange[1,1])
effluentchange[,1:3] <-round(effluentchange[,1:3],2)

#then simple plot
#first add in the Presidential Years
effluentviolations$President <- as.character("Bush")
effluentviolations[9:16,3] <- as.character("Obama")
effluentviolations[17:19,3] <- as.character("Trump")

effluentgraph <- ggplot(effluentviolations, mapping=aes(x=factor(Year),
  y=Violations, fill=President, group=1))+
  geom_bar(stat="identity")+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Violations", x="Year", title="Clean Water Act Violations\n", subtitle ="Mostly complete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(effluentviolations$Violations+(.2*max(effluentviolations$Violations)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=9),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5, size=9), plot.title = 
          element_text(lineheight = .1, size=10))

##Inspections % change and graph

##So, we're going to do the first 3 years of Obama and Trump so average
#[9:11,2] Obama
# [17:19,2] Trump
inspections <- `inspections_All_pg3_VA-4`
names(inspections)[1] <- "Date"
inspections <- inspections[-c(20),]
inspectionchange <- data.frame("Obama Average" =mean(inspections[9:11,2]),
                             "Trump Average" =mean(inspections[17:19,2]))
inspectionchange$PercentDifference <- as.numeric(100*(inspectionchange[1,2]-inspectionchange[1,1])/
                                                 inspectionchange[1,1])
inspectionchange[,1:3] <-round(inspectionchange[,1:3],0)

#syntax for bullet points
inspectionchange$Change <- ifelse(inspectionchange$PercentDifference>=0, "increase", "decrease")
inspectionchange$Positive <- abs(inspectionchange$PercentDifference)

#then simple plot
#first add in the Presidential Years
inspections$President <- as.character("Bush")
inspections[9:16,3] <- as.character("Obama")
inspections[17:19,3] <- as.character("Trump")

inspectiongraph <- ggplot(inspections, mapping=aes(x=factor(Date),
                                                        y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y="Inspections", x="Year", title="Facility Inspections-CAA,CWA,RCRA\n", subtitle = "Potentially incomplete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(inspections$Count+(.2*max(inspections$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=9),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5, size=9), plot.title = 
          element_text(lineheight = .1, size=10))

#enforcement
##So, we're going to do the first 3 years of Obama and Trump so average
#[9:11,2] Obama
# [17:19,2] Trump
enforcement <- `enforcements_All_pg3_VA-4`
names(enforcement)[1] <- "Date"
enforcement <- enforcement[-c(20),]
enforcement$Amount <- round(enforcement$Amount,0)
enforcementchange <- data.frame("Obama Average Count" =mean(enforcement[9:11,3]),
                               "Trump Average Count" =mean(enforcement[17:19,3]),
                               "Obama Average Fine" =mean(enforcement[9:11,2]),
                               "Trump Average Fine" =mean(enforcement[17:19,2]))
enforcementchange$PercentDifferenceCount <- as.numeric(100*(enforcementchange[1,2]-enforcementchange[1,1])/
                                                   enforcementchange[1,1])
enforcementchange$PercentDifferenceFine <- as.numeric(100*(enforcementchange[1,4]-enforcementchange[1,3])/
                                                         enforcementchange[1,3])
enforcementchange[,1:6] <-round(enforcementchange[,1:6],0)

#syntax for bullet points
enforcementchange$CountChange <- ifelse(enforcementchange$PercentDifferenceCount>=0, "increase", "decrease")
enforcementchange$PositiveCount <- abs(enforcementchange$PercentDifferenceCount)
enforcementchange$FineChange <- ifelse(enforcementchange$PercentDifferenceFine>=0, "increase", "decrease")
enforcementchange$PositiveFine <- abs(enforcementchange$PercentDifferenceFine)

#adjust for inflation
inflation <- inflation[-c(20:107),]
enforcement <- cbind(enforcement, inflation)
enforcement$inflationadjust <- as.numeric(enforcement$Amount*enforcement$base)

##make a new amount column /1000
enforcement$Amountinthousands <- ((enforcement$inflationadjust)/1000)
enforcement$Amountinthousands <-round(enforcement$Amountinthousands,2)

#add presidental years
enforcement$President <- as.character("Bush")
enforcement[9:16,5] <- as.character("Obama")
enforcement[17:19,5] <- as.character("Trump")

#plot change in enforcement
enforcementactiongraph <- ggplot(enforcement, mapping=aes(x=factor(Date),y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y="# Actions", x="Year", title="Enforcement Actions-CAA,CWA,RCRA\n", subtitle = "Potentially incomplete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(effluentviolations$Violations+(.2*max(effluentviolations$Violations)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016,2019))+
  geom_text(aes(label=Count, family="Georgia", fontface="bold"), position = position_dodge(0.9), vjust = -0.1, size=3)+
  theme_meg()+
  theme(axis.text.x=element_text(size=9),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5, size=9), plot.title = 
          element_text(lineheight = .1, size=10))

enforcementfinegraph <- enforcement %>% ggplot()+
  geom_bar(aes(x=factor(Date),y=Amountinthousands , fill=President, group=1),stat="identity", show.legend=FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y="Fines ($1000s)", x="Year", caption="Values adjusted for inflation. Note, the y-axis reports values in 1000's. A value of $2000\nrepresents $2,000,000 (2 million dollars).", title="Enforcement Fines-CAA,CWA,RCRA\n", subtitle="Potentially incomplete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(enforcement$Amountinthousands+(.2*max(enforcement$Amountinthousands)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=9),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5, size=9), plot.caption = element_text(size=10), plot.title = 
          element_text(lineheight = .1, size=10))

```
# Highlights for Virginia's 4th District

* <h3>Comparing the first 3 years of the Obama administration to the first 3 years of the Trump administration, there has been a <span style="color:#569b5e">`r inspectionchange[1,5]`% `r inspectionchange[1,4]` in inspections,  `r enforcementchange[1,10]`%  `r enforcementchange[1,9]` in fines</span>, and a <span style="color:#569b5e">`r enforcementchange[1,8]`% `r enforcementchange[1,7]` in enforcement actions.</span></h3>

<br />

* <h3>Under the Clean Water Act, the regulation most well-reported by EPA in this report, <span style="color:#569b5e">`r CWArecurring[2,2]` facilities, representing `r CWArecurring[2,3]`% of all regulated facilities in VA4,</span> were in violation for <span style="color:#569b5e">at least 9 months of the last 3 years.</span></h3>
```{r echo=FALSE, out.width= "95%", out.extra='style="float:center; padding:0px"'}

effluentgraph/inspectiongraph/enforcementactiongraph/enforcementfinegraph

```

### Figures throughout this report indicate reliability by the subtitle and the degree of transparency of the data. See the data limitations page to view the ransparency-coding table and access the data here (NEED LINK HERE).


\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 3</span></h4>

# This District in Comparison
```{r, fig.height = 6, fig.width = 8, fig.align = "left"}

#comparing inspections

#let's combine the inspections data at national, state, CD level 
names(USAinspectionsper1000_All)[2] <- "Inspectionsper1000"
USAinspectionsper1000_All$Region <- as.factor("National")
names(`inspectionsper1000_All_pg4_VA-090820.csv`)[2] <- "Inspectionsper1000"
`inspectionsper1000_All_pg4_VA-090820.csv`$Region <- as.factor("State")
names(`inspectionsper1000_All_pg4_VA-4`)[2] <- "Inspectionsper1000"
`inspectionsper1000_All_pg4_VA-4`$Region <- as.factor("Congressional District")
inspectionsper1000 <- rbind(USAinspectionsper1000_All, `inspectionsper1000_All_pg4_VA-090820.csv`, `inspectionsper1000_All_pg4_VA-4`)
inspectionsper1000$Inspectionsper1000 <- as.numeric(inspectionsper1000$Inspectionsper1000)
inspectionsper1000[2] <-round(inspectionsper1000[2],0) 

#Now let's visualize this 
inspect1000bar <- ggplot(inspectionsper1000, aes(fill=Region, y=Inspectionsper1000, x=Program, alpha=Program))+
  geom_bar(position="dodge", stat="identity")+
  scale_fill_manual(values=c("#999999" , "#333333", "#d43a69"))+
  labs(y="Inspections per 1000 Facilities\n", x="")+
  scale_alpha_manual(values=c(.6,1,.6), guide='none')+
  geom_text(aes(label=Inspectionsper1000, family="Georgia"), position = position_dodge(0.9), vjust = -0.1, size=4)+
  ggtitle("Inspections per 1000 Facilities in 2019")+
  scale_y_continuous(expand=c(0,0),limits=c(0,max(inspectionsper1000$Inspectionsper1000+(.2*max(inspectionsper1000$Inspectionsper1000)))))+
  theme_meg()
  

#comparing violations
#let's combine the violations data at national, state, CD level 
names(USAviolationsper1000_All)[2] <- "violationsper1000"
USAviolationsper1000_All$Region <- as.factor("National")
names(`violationsper1000_All_pg4_VA-090820.csv`)[2] <- "violationsper1000"
`violationsper1000_All_pg4_VA-090820.csv`$Region <- as.factor("State")
names(`violationsper1000_All_pg4_VA-4`)[2] <- "violationsper1000"
`violationsper1000_All_pg4_VA-4`$Region <- as.factor("Congressional District")
violationsper1000 <- rbind(USAviolationsper1000_All, `violationsper1000_All_pg4_VA-090820.csv`, `violationsper1000_All_pg4_VA-4`)
violationsper1000$violationsper1000 <- as.numeric(violationsper1000$violationsper1000)
violationsper1000[2] <-round(violationsper1000[2],0)

#Now let's visualize this 
violations1000bar <- ggplot(violationsper1000, aes(fill=Region, y=violationsper1000, x=Program, alpha=Program))+
  geom_bar(position="dodge", stat="identity", show.legend=FALSE)+
  scale_fill_manual(values=c("#999999" , "#333333", "#d43a69"))+
  scale_alpha_manual(values=c(.3,1,.3), guide='none')+
  labs(y="Violations per 1000 Facilities", x="")+
  geom_text(aes(label=violationsper1000, family="Georgia"), position = position_dodge(0.9), vjust = -0.1, size=4)+
  ggtitle("Violations per 1000 Facilities in 2019")+
  scale_y_continuous(expand=c(0,0),limits=c(0,max(violationsper1000$violationsper1000+(.2*max(violationsper1000$violationsper1000)))))+
  theme_meg()+
  theme(legend.position = c(0.8, 0.5))

inspect1000bar / violations1000bar
  
```
<br />

These two charts show how inspections and violations in this district compare to the national and state averages per 1000 facilities in 2019. We use data from 2019 as it was the most recent full year and the ECHO database only reports *currently* active facilities. To enable comparison across locations with a differing number of active facilities, we standardize the comparison to a value per 1000 facilities, proportionally adjusting the data if there are more or less than 1000 facilities in a district or state. 


\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 4</span></h4> 

<h1><span style="margin-bottom:0px; padding-bottom:0px">Recent Non-Compliance in this District</span></h1>

These figures show the ten facilities in this district with the worst history of environmental compliance based on their number of noncompliant quarters in the past 3 years (not necessarily consequcetive).
```{r, fig.height = 7, fig.width = 5, fig.align = "left"}
#call in data and clean up 
CAAbadactors <- `noncomp_CAA_pg6_VA-4`
CAAbadactors <-CAAbadactors[!(CAAbadactors$noncomp_count==0),]
CAAbadactors <- CAAbadactors[-c(11:20),]
CAAbadactors$Facility <- CAAbadactors$FAC_NAME
CAAbadactors$Facility <- strtrim(CAAbadactors$Facility, 35)


#Let's try the CAA plot 

CAAfacilities <- CAAbadactors %>%
  mutate(Facility = fct_reorder(Facility, noncomp_count)) %>%
  ggplot( mapping=aes(x=Facility, y=noncomp_count, fill=Facility, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, width=.8)+
  scale_fill_viridis(discrete = TRUE, option="B")+
  labs(y="Quarters in Violation", x="", title="CAA Violators")+
  scale_y_continuous(expand=c(0,0))+
  scale_x_discrete(expand=c(0,0))+
  theme_meg()+
  theme(axis.text.y=element_text(size=12, face = "bold", color="black"), axis.title.x = element_text(size=14), axis.text.x=element_text(size=14,face = "bold"), plot.title=element_text(size=16))+
  coord_flip()


#call in data and clean up 
CWAbadactors <- `noncomp_CWA_pg6_VA-4`
CWAbadactors <-CWAbadactors[!(CWAbadactors$noncomp_count==0),]
CWAbadactors <- CWAbadactors[-c(11:20),]
CWAbadactors$Facility <- CWAbadactors$FAC_NAME
CWAbadactors$Facility <- strtrim(CWAbadactors$Facility, 35)



#Let's try the CWA plot 

CWAfacilities <- CWAbadactors %>%
  mutate(Facility = fct_reorder(Facility, noncomp_count)) %>%
  ggplot( mapping=aes(x=Facility, y=noncomp_count, fill=Facility, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, width=.8)+
  scale_fill_viridis(discrete = TRUE, option="B")+
  labs(y="Quarters in Violation", x="", title="CWA Violators")+
  scale_y_continuous(expand=c(0,0),breaks=c(0,3,6,9,13))+
  scale_x_discrete(expand=c(0,0))+
  theme_meg()+
  theme(axis.text.y=element_text(size=12, face = "bold", color="black"), axis.title.x = element_text(size=14), axis.text.x=
          element_text(size=14,face = "bold"), plot.title=element_text(size=16))+
  coord_flip()



#call in data and clean up 
RCRAbadactors <- `noncomp_RCRA_pg7_VA-4`
RCRAbadactors <-RCRAbadactors[!(RCRAbadactors$noncomp_count==0),]
RCRAbadactors <- RCRAbadactors[-c(11:20),]
RCRAbadactors$Facility <- RCRAbadactors$FAC_NAME
RCRAbadactors$Facility <- strtrim(RCRAbadactors$Facility, 35)



#Let's try the RCRA plot 

RCRAfacilities <- RCRAbadactors %>%
  mutate(Facility = fct_reorder(Facility, noncomp_count)) %>%
  ggplot( mapping=aes(x=Facility, y=noncomp_count, fill=Facility, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, width=.8)+
  scale_fill_viridis(discrete = TRUE, option="B")+
  labs(y="Quarters in Violation", x="", title="RCRA Violators")+
  scale_y_continuous(expand=c(0,0))+
  scale_x_discrete(expand=c(0,0))+
  theme_meg()+
  theme(axis.text.y=element_text(size=12, face = "bold", color="black"), axis.title.x = element_text(size=14), axis.text.x=
          element_text(size=14,face = "bold"), plot.title=element_text(size=16))+
  coord_flip()

#CAAfacilities / CWAfacilities / RCRAfacilities 

ggsave("CAAfacilities.jpeg", CAAfacilities, path=here("VA4"), scale = 3, width=7, height=4, units=c("cm"))
ggsave("CWAfacilities.jpeg", CWAfacilities, path=here("VA4"), scale = 3, width=7, height=4, units=c("cm"))
ggsave("RCRAfacilities.jpeg", RCRAfacilities, path=here("VA4"), scale = 3, width=7, height=4, units=c("cm"))

```
<a ><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/VA4/CAAfacilities.jpeg" style="float: left; width: 65%; height: 60%; margin-right: 5%" ></a>

<font size="3">**ECHO reports for facilities:**</font>

* <font size="2">[`r CAAbadactors[1,6] `](`r CAAbadactors[1,5] `)</font>
* <font size="2">[`r CAAbadactors[2,6] `](`r CAAbadactors[2,5] `)</font>
* <font size="2">[`r CAAbadactors[3,6] `](`r CAAbadactors[3,5] `)</font>
* <font size="2">[`r CAAbadactors[4,6] `](`r CAAbadactors[4,5] `)</font>
* <font size="2">[`r CAAbadactors[5,6] `](`r CAAbadactors[5,5] `)</font>
* <font size="2">[`r CAAbadactors[6,6] `](`r CAAbadactors[6,5] `)</font>
* <font size="2">[`r CAAbadactors[7,6] `](`r CAAbadactors[7,5] `)</font>
* <font size="2">[`r CAAbadactors[8,6] `](`r CAAbadactors[8,5] `)</font>
* <font size="2">[`r CAAbadactors[9,6] `](`r CAAbadactors[9,5] `)</font>
* <font size="2">[`r CAAbadactors[10,6] `](`r CAAbadactors[10,5] `)</font>

<a ><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/VA4/CWAfacilities.jpeg" style="float: left; width: 65%; height: 60%; margin-right: 5%" ></a>

<font size="3">**ECHO reports for facilities:**</font>

* <font size="2">[`r CWAbadactors[1,6] `](`r CWAbadactors[1,5] `)</font>
* <font size="2">[`r CWAbadactors[2,6] `](`r CWAbadactors[2,5] `)</font>
* <font size="2">[`r CWAbadactors[3,6] `](`r CWAbadactors[3,5] `)</font>
* <font size="2">[`r CWAbadactors[4,6] `](`r CWAbadactors[4,5] `)</font>
* <font size="2">[`r CWAbadactors[5,6] `](`r CWAbadactors[5,5] `)</font>
* <font size="2">[`r CWAbadactors[6,6] `](`r CWAbadactors[6,5] `)</font>
* <font size="2">[`r CWAbadactors[7,6] `](`r CWAbadactors[7,5] `)</font>
* <font size="2">[`r CWAbadactors[8,6] `](`r CWAbadactors[8,5] `)</font>
* <font size="2">[`r CWAbadactors[9,6] `](`r CWAbadactors[9,5] `)</font>
* <font size="2">[`r CWAbadactors[10,6] `](`r CWAbadactors[10,5] `)</font>

<a ><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/VA4/RCRAfacilities.jpeg" style="float: left; width: 65%; height: 60%; margin-right: 5%" ></a>

<font size="3">**ECHO reports for facilities:**</font>

* <font size="2">[`r RCRAbadactors[1,6] `](`r RCRAbadactors[1,5] `)</font>
* <font size="2">[`r RCRAbadactors[2,6] `](`r RCRAbadactors[2,5] `)</font>
* <font size="2">[`r RCRAbadactors[3,6] `](`r RCRAbadactors[3,5] `)</font>
* <font size="2">[`r RCRAbadactors[4,6] `](`r RCRAbadactors[4,5] `)</font>
* <font size="2">[`r RCRAbadactors[5,6] `](`r RCRAbadactors[5,5] `)</font>
* <font size="2">[`r RCRAbadactors[6,6] `](`r RCRAbadactors[6,5] `)</font>
* <font size="2">[`r RCRAbadactors[7,6] `](`r RCRAbadactors[7,5] `)</font>
* <font size="2">[`r RCRAbadactors[8,6] `](`r RCRAbadactors[8,5] `)</font>
* <font size="2">[`r RCRAbadactors[9,6] `](`r RCRAbadactors[9,5] `)</font>
* <font size="2">[`r RCRAbadactors[10,6] `](`r RCRAbadactors[10,5] `)</font>

\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 5</span></h4>

# Clean Air Act

<div class="text-box-info">

The [Clean Air Act (CAA)](https://www.epa.gov/laws-regulations/summary-clean-air-act) is the comprehensive federal law that regulates air emissions from stationary and mobile sources such as refineries, power plants and cars. For the CAA, violations are most commonly recognized via inspections. Infrequent inspection usually results in fewer identified violations. If CAA violations have decreased, make sure to check whether inspections have also decreased as recent cuts in inspections are likely related to drops in CAA violations. Unless thorough inspections are occurring regularly, fewer violations does not necessarily mean air quality has improved. 
[More info on CAA](https://docs.google.com/presentation/d/1MzRQf3QeJqmYMSttdk0ghrXeOmOZgOV_MTynl-ri6Ik/edit?usp=sharing)
</div>
<h2>There are `r activefacilities[1,2] ` facilities currently reporting under the  
`r activefacilities[1,1]`</h2>
```{r, fig.height = 5, fig.width = 8, fig.align = "center"}

#clean up data
CAAviolations <- `violations_CAA_pg5_VA-4` 
names(CAAviolations)[1] <- "Date"
CAAviolations <- CAAviolations[-c(20),]
CAAviolations$President <- as.character("Bush")
CAAviolations[9:16,3] <- as.character("Obama")
CAAviolations[17:19,3] <- as.character("Trump")



vCAAgraph <- ggplot(CAAviolations, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.3)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Violations", x="Year", title="CAA violations\n", subtitle ="Very incomplete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CAAviolations$Count+(.2*max(CAAviolations$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

#clean up data
CAAinspections <- `inspections_CAA_pg5_VA-4`
names(CAAinspections)[1] <- "Date"
CAAinspections <- CAAinspections[-c(20),]
CAAinspections$President <- as.character("Bush")
CAAinspections[9:16,3] <- as.character("Obama")
CAAinspections[17:19,3] <- as.character("Trump")

iCAAgraph <- ggplot(CAAinspections, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Inspections", x="Year", title="CAA Inspections\n", subtitle ="Potentially incomplete data")+
  #ggtitle("CAA Inspections")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CAAinspections$Count+(.2*max(CAAinspections$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016, 2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

#clean up data
CAAenforcement <- `enforcements_CAA_pg5_VA-4`
CAAenforcement <- CAAenforcement[-c(20),]
names(CAAenforcement)[1] <- "Date"
CAAenforcement$President <- as.character("Bush")
CAAenforcement[9:16,4] <- as.character("Obama")
CAAenforcement[17:19,4] <- as.character("Trump")

#adjust for inflation
CAAenforcement <- cbind(CAAenforcement, inflation)
CAAenforcement$inflationadjust <- as.numeric(CAAenforcement$Amount*CAAenforcement$base)

##make a new amount column /1000
CAAenforcement$Amountinthousands <- ((CAAenforcement$inflationadjust)/1000)
CAAenforcement$Amountinthousands <-round(CAAenforcement$Amountinthousands,2)

eCAAgraph <- ggplot(CAAenforcement, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Actions", x="Year", title="CAA Enforcement Actions\n", subtitle ="Potentially incomplete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CAAviolations$Count+(.2*max(CAAviolations$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016, 2019))+
  geom_text(aes(label=Count, family="Georgia", fontface="bold"), position = position_dodge(0.9), vjust = -0.1, size=3)+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

fineCAAgraph <- ggplot(CAAenforcement, mapping=aes(x=factor(Date), y=Amountinthousands, fill=President, group=1))+
  geom_bar(stat="identity", alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" Fines ($1000s)", x="Year", title="CAA Fines\n", subtitle ="Potentially incomplete data", caption="Values adjusted for inflation. Note, the y-axis reports values in\n1000's. A value of $2000 represents $2,000,000 (2 million dollars).")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CAAenforcement$Amountinthousands+(.2*max(CAAenforcement$Amountinthousands)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016, 2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5), plot.caption = element_text(size=8))



(iCAAgraph | vCAAgraph) / (eCAAgraph | fineCAAgraph)



```
These figures show patterns of CAA inspections, violations, enforcement actions and fines in this district since 2001 based on available EPA data (see page 9). The bars are colored by president. Figure transparency illustrates data reliability: the more transparent, the more uncertain the data. Data on CAA violations is particularly unreliable as emissions are often not directly monitored but are estimates. Inspection, enforcement, and fine data can be unreliable state reporting to ECHO may be incomplete.
<br />
<br />

\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 6</span></h4> 

# Clean Water Act 

<div class="text-box-info">

The [Clean Water Act (CWA)](https://www.epa.gov/laws-regulations/summary-clean-water-act) regulates the discharge of hazardous pollutants into and establishes quality standards for the waters of the United States. The CWA established the National Pollutant Discharge Elimination System (NPDES) which permits facilities to discharge certain kinds and amounts of pollutants. Unlike the CAA, effluent (waste emissions) from CWA facilities is routinely reported electronically to ECHO. Levels of contaminants reported over permitted levels triggers a NPDES violation automatically. Therefore, CWA violations are recorded independently of facility inspections and inspections often occur in response to recorded violations.[More info on CWA](https://docs.google.com/presentation/d/1g6ZN3B5jvs3F1VAigiUtNNezjXdJnzuELfo9Deo9Y2w/edit?usp=sharing)
</div>
<h2>There are `r activefacilities[2,2] ` facilities currently reporting under the 
`r activefacilities[2,1]`</h2>
```{r, fig.height = 5, fig.width = 8, fig.align = "center"}

#clean up data

# data cleaned elsewhere
#plot
vCWAgraph <- ggplot(CWAviolations, mapping=aes(x=factor(YEAR), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Violations", x="Year", title="CWA Violations\n", subtitle ="Mostly complete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CWAviolations$Count+(.2*max(CWAviolations$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

#clean up data
CWAinspections <- `inspections_CWA_pg6_VA-4`
names(CWAinspections)[1] <- "Date"
CWAinspections <- CWAinspections[-c(20),]
CWAinspections$President <- as.character("Bush")
CWAinspections[9:16,3] <- as.character("Obama")
CWAinspections[17:19,3] <- as.character("Trump")

iCWAgraph <- ggplot(CWAinspections, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Inspections", x="Year", title="CWA Inspections\n", subtitle ="Potentially incomplete data")+
  ggtitle("CWA Inspections")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CWAinspections$Count+(.2*max(CWAinspections$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016, 2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

#clean up data
CWAenforcement <- `enforcements_CWA_pg6_VA-4`
names(CWAenforcement)[1] <- "Date"
CWAenforcement <- CWAenforcement[-c(20),]
CWAenforcement$President <- as.character("Bush")
CWAenforcement[8:16,4] <- as.character("Obama")
CWAenforcement[17:19,4] <- as.character("Trump")

#adjust for inflation
CWAenforcement <- cbind(CWAenforcement, inflation)
CWAenforcement$inflationadjust <- as.numeric(CWAenforcement$Amount*CWAenforcement$base)

##make a new amount column /1000
CWAenforcement$Amountinthousands <- ((CWAenforcement$inflationadjust)/1000)
CWAenforcement$Amountinthousands <-round(CWAenforcement$Amountinthousands,2)

eCWAgraph <- ggplot(CWAenforcement, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Actions", x="Year", title="CWA Enforcement Actions\n", subtitle="Potentially incomplete data")+
  #ggtitle("CWA Enforcement Actions")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CWAviolations$Count+(.2*max(CWAviolations$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016, 2019))+
  geom_text(aes(label=Count, family="Georgia", fontface="bold"), position = position_dodge(0.9), vjust = -0.1, size=3)+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

fineCWAgraph <- ggplot(CWAenforcement, mapping=aes(x=factor(Date), y=Amountinthousands, fill=President, group=1))+
  geom_bar(stat="identity", alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" Fines($1000s)", x="Year", title="CWA Fines\n", subtitle="Potentially incomplete data", caption="Values adjusted for inflation. Note, the y-axis reports values in\n1000's. A value of $2000 represents $2,000,000 (2 million dollars).")+
  #ggtitle("CWA Fines")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(CWAenforcement$Amountinthousands+(.2*max(CWAenforcement$Amountinthousands)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5), plot.caption = element_text(size=8))


(iCWAgraph | vCWAgraph) / (eCWAgraph | fineCWAgraph)



```	
These figures show patterns of Clean Water Act inspections, violations, enforcement actions and fines in this district since 2001 based on available EPA data (see page 9). The bars are colored by president. Figure transparency illustrates data reliability: the more transparent, the more uncertain the data. Data on CWA violations is particularly reliable as effluent violations are automatically reported to EPA.
<br />
<br />
<br />
<br />

\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 7</span></h4>

# Resource Conservation and Recovery Act 


<div class="text-box-info">

The [Resource Conservation and Recovery Act (RCRA)](https://www.epa.gov/laws-regulations/summary-resource-conservation-and-recovery-act) gives EPA the authority to control hazardous waste from the "cradle-to-grave", regulating the generation, transportation, treatment, storage, and disposal of hazardous waste. Facilities self-report under RCRA, like the CAA, and violations are most often found after an inspection. If RCRA violations have decreased, make sure to check whether inspections have also decreased as recent cuts in inspections are likely related to drops in RCRA violations. [More info on RCRA](https://docs.google.com/presentation/d/1lV9b_vkcfCbTz8uss1XjXLHy2svpi2tmizb6et1Wfkc/edit?usp=sharing)
</div>
<h2>There are `r activefacilities[3,2] ` facilities currently reporting under
`r activefacilities[3,1]`</h2>
```{r, fig.height = 5, fig.width = 8, fig.align = "center"}

#clean up data
RCRAviolations <- `violations_RCRA_pg7_VA-4`
names(RCRAviolations)[1] <- "Date"
RCRAviolations <- RCRAviolations[-c(20),]
RCRAviolations$President <- as.character("Bush")
RCRAviolations[9:16,3] <- as.character("Obama")
RCRAviolations[17:19,3] <- as.character("Trump")

vRCRAgraph <- ggplot(RCRAviolations, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.3)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Violations", x="Year", title = "RCRA violations\n", subtitle = "Very incomplete data")+
  #ggtitle("RCRA violations")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(RCRAviolations$Count+(.2*max(RCRAviolations$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

#clean up data
RCRAinspections <- `inspections_RCRA_pg7_VA-4`
names(RCRAinspections)[1] <- "Date"
RCRAinspections <- RCRAinspections[-c(20),]
RCRAinspections$President <- as.character("Bush")
RCRAinspections[9:16,3] <- as.character("Obama")
RCRAinspections[17:19,3] <- as.character("Trump")

iRCRAgraph <- ggplot(RCRAinspections, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Inspections", x="Year", title="RCRA Inspections\n", subtitle="Potentially incomplete data")+
  #ggtitle("RCRA Inspections")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(RCRAinspections$Count+(.2*max(RCRAinspections$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012,2016, 2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))


#clean up data
RCRAenforcement <- `enforcements_RCRA_pg7_VA-4`
names(RCRAenforcement)[1] <- "Date"
RCRAenforcement <- RCRAenforcement[-c(20),]
RCRAenforcement$President <- as.character("Bush")
RCRAenforcement[8:16,4] <- as.character("Obama")
RCRAenforcement[17:19,4] <- as.character("Trump")

#adjust for inflation
RCRAenforcement <- cbind(RCRAenforcement, inflation)
RCRAenforcement$inflationadjust <- as.numeric(RCRAenforcement$Amount*RCRAenforcement$base)

##make a new amount column /1000
RCRAenforcement$Amountinthousands <- ((RCRAenforcement$inflationadjust)/1000)
RCRAenforcement$Amountinthousands <-round(RCRAenforcement$Amountinthousands,2)

eRCRAgraph <- ggplot(RCRAenforcement, mapping=aes(x=factor(Date), y=Count, fill=President, group=1))+
  geom_bar(stat="identity", show.legend = FALSE, alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" # Actions", x="Year", title="RCRA Enforcement Actions\n", subtitle = "Potentially incomplete data")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(RCRAviolations$Count+(.2*max(RCRAviolations$Count)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016, 2019))+
  geom_text(aes(label=Count, family="Georgia", fontface="bold"), position = position_dodge(0.9), vjust = -0.1, size=3)+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5))

fineRCRAgraph <- ggplot(RCRAenforcement, mapping=aes(x=factor(Date), y=Amountinthousands, fill=President, group=1))+
  geom_bar(stat="identity", alpha=.6)+
  scale_fill_manual(values=c("#450d54", "#22908d", "#e56d13"))+
  labs(y=" Fines($1000s)", x="Year", title="RCRA Fines\n", subtitle = "Potentially incomplete data", caption="Values adjusted for inflation. Note, the y-axis reports values in\n1000's. A value of $2000 represents $2,000,000 (2 million dollars).")+
  scale_y_continuous(expand=c(0,0), limits=c(0,max(RCRAenforcement$Amountinthousands+(.2*max(RCRAenforcement$Amountinthousands)))))+
  scale_x_discrete(breaks=c(2004,2008,2012, 2016,2019))+
  theme_meg()+
  theme(axis.text.x=element_text(size=10),
        axis.title.x = element_blank(), plot.subtitle = element_text(hjust=.5), plot.caption = element_text(size=8))


(iRCRAgraph | vRCRAgraph) / (eRCRAgraph | fineRCRAgraph)



```	
These figures show patterns of RCRA inspections, violations, enforcement actions and fines in this district since 2001 based on available EPA data (see page 9). The bars are colored by president. Figure transparency illustrates data reliability: the more transparent, the more uncertain the data. Data on RCRA violations is particularly unreliable as violations are not necessarily directly measured. Inspection, enforcement, and fine data can be unreliable state reporting to ECHO may be incomplete.
<br />
<br />
<br />
<br />
<br />
<br />

\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 8</span></h4>

```{r echo=FALSE}

VA4 <- housemembers[which(housemembers$CD=="VA4"), ]

```
# Legislator Information 
<br />
<a ><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/VA4/donald_mceachin.png" style="float: left; width: 25%; margin-right: 5%" ></a>


<h2>[`r VA4[1,2]`](`r VA4[1,9]`) <span style="color:#25539f">(`r VA4[1,3]`)</span></h2>

## In office since `r VA4[1,6]` `r VA4[1,7]`, `r VA4[1,8]`

## Relevant Committee Membership:  [Energy and Commerce Committee](https://energycommerce.house.gov/)
<br />
<br />
<div class="text-box-info">
### The House Energy and Commerce Committee
This Committee is the oldest house Committee with the broadest jurisdiction of any authorizing committee. The Committee oversees the EPA, and legislates on issues like environmental protection, clean air, climate change, safe drinking water, toxic chemicals and hazardous waste, and nuclear facilities. Currently, the Committee consists of 55 members – 24 Republicans and 31 Democrats. The subcommittees of primary interest to these reports are Environment & Climate Change and Oversight & Investigations. 
</div>

<br />

### Relevant Subcommittees: 
[`r VA4[1,10]`](`r VA4[1,11]`)

<br />

[`r VA4[1,12]`](`r VA4[1,13]`)

<br />

[`r VA4[1,14]`](`r VA4[1,15]`)

<br />

[`r VA4[1,16]`](`r VA4[1,17]`)


\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 9</span></h4> 

# About the EPA Data Analyzed in this Report Card and its Limitations  
The data in this report is from EPA’s publicly-available [ECHO database](https://echo.epa.gov/) that compiles information from a number of distinct state and federal sources. However, poor reporting by states and inconsistent reporting schemes result in data gaps and inaccuracies. 

EPA lists numerous specific issues on its [“Known Data Problems”](https://echo.epa.gov/resources/echo-data/known-data-problems) page. In addition, EPA [notes](https://echo.epa.gov/tools/data-downloads) that data on inspections, violations, and enforcement actions from prior to 2001 should be treated as incomplete and unreliable. For that reason, we have only tracked data back to 2001. In addition to many data entry errors -- too numerous to list here -- there are several major problems with ECHO: 

* There is serious under-recording and under-reporting of CAA violations at the state level. Most CAA violations -- [perhaps 85% or more](http://eelp.law.harvard.edu/wp-content/uploads/Cynthia-Giles-Part-2-FINAL.pdf) -- do not make it into ECHO. Violation data is therefore inaccurate and misleading: states which report the fewest violations may be states whose recording and reporting of violations is actually the poorest.
* Although there is no specific information about the quality of data on RCRA violations, it is likely that this program, like the CAA, has serious reporting problems. Therefore, RCRA violations data should also be considered inaccurate and potentially misleading. The key difference between these and the CWA is that the CWA entails mandatory electronic self-reporting.
* ECHO does not record how many regulated facilities there were for programs in previous years. Therefore, we cannot calculate the number of inspections, enforcement actions, and violations per regulated facility before 2019.

### Data reliability coding

In this report, we have divided data issues into three categories, using transparencies in graphs as well as subtitles to indicate data reliability and completeness. See the table below: 

(put table here)

<br />

<div class="text-box-info">
<h3>Note on 2020 data</h3>
<p>We do not include data from 2020 because we are only part way through the year. It is important to note, as well, that data from 2020 will be strongly influenced by the EPA’s decision to suspend, from March through August, pollution monitoring requirements for industries that claim to have been impacted by COVID-19. EDGI’s report on this policy [“More Permission to Pollute”](https://envirodatagov.org/more-permission-to-pollute-the-decline-of-epa-enforcement-and-industry-compliance-during-covid/) found that, despite relatively few facilities claiming the COVID exemption, a much larger proportion of facilities are still failing to report. 
.</p>
</div>

\pagebreak

<hr style="height:3px;border-width:0;color: #C1E0D7;background-color: #C1E0D7; margin-top: 2em">
<h4>DRAFT not for circulation <span style="padding-left:450px">Page 10</span></h4>

# About the Authors

### About EEW and this Project

Environmental Enforcement Watch (EEW) is a collaborative project across EDGI working groups. The EEW project builds on EDGI’s 2019 [Sheep in the Closet Report](https://envirodatagov.org/publication/a-sheep-in-the-closet-the-erosion-of-enforcement-at-the-epa/) that documents large declines in EPA enforcement of environmental laws. This project and others used data from EPA’s [ECHO](https://echo.epa.gov/) database, revealing how useful ECHO could be for communities to track pollution and EPA responses in their areas. However, they also revealed the inaccessibility of ECHO for non-specialists, along with maOR omissions, errors, and confusions present in the data itself.

A key goal of EEW is to highlight gaps and inadequacies in the enforcement of environmental laws, demonstrating EPA’s failure to fulfill its congressionally mandated duty. To help bring awareness and action to the state of environmental non-compliance across the US, we are using Jupyter Notebooks that utilize ECHO data to present these congressional report cards for the 75 Senators and House Representatives that sit on the House Energy & Commerce Committee and the Senate Environment & Public Works Committee. By providing a novel and poignant look at the chronic state of non-compliance in their states and districts, we hope to provide these key representatives with the information and pressure they need to hold the EPA accountable. 


<div class="text-box-info">

<h3>About EDGI</h3>
<p>EDGI is an international network of over 175 members from more than 80 different academic institutions and non-profits, comprised foremost by grassroots volunteer efforts. Since 2016, EDGI has served as a preeminent watchdog group for federal environmental data, generating international effort to duplicate and monitor repositories of public data that are vital to environmental health research and knowledge.
EDGI’s work has been widely acknowledged, leading to EDGI testifying before Congress on declines in EPA enforcement, and hundreds of mentions in leading national and international media such as _The New York Times_,_The Washington Post_, Vice News, and CNN. For more about our work, read our [2019 Annual Report](https://envirodatagov.org/publication/edgi-annual-report-2019/)and [2020 Annual Report](https://envirodatagov.org/publication/edgi-annual-report-2020/).<p>

</div>


#### [Contact Us](https://www.environmentalenforcementwatch.org/contact/)

<a href="https://www.environmentalenforcementwatch.org/"><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/reportcards/eew_logo.png" style="float: left; width: 25%; margin-left: 20%" ></a>

<a href="https://envirodatagov.org/"><img src="/Users/mraisle/Documents/OneDrive - University of North Carolina at Chapel Hill/CD-report/reportcards/edgi_logo.png" style="float: right; width: 35%; margin-right: 20%" ></a>

